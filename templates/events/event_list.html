{% extends "base.html" %}

{% block title %}Events{% endblock %}

{% block content %}
<h2>All Events</h2>
<ul>
{% for event in events %}
    <li>
        <strong>{{ event.title }}</strong> - {{ event.date }} - {{ event.location }} (by {{ event.organizer.username }})
        {% if user.is_authenticated %}
            {% if user == event.organizer %}
                | <a href="{% url 'event_edit' event.pk %}">Edit</a>
                | <a href="{% url 'event_delete' event.pk %}">Delete</a>
            {% else %}
                {% if event.pk in user_rsvps %}
                | <form method="post" action="{% url 'rsvp_cancel' event.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">Cancel RSVP</button>
                </form>
                {% else %}
                | <form method="post" action="{% url 'rsvp' event.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">RSVP</button>
                </form>
                {% endif %}
            {% endif %}
        {% endif %}
    </li>
{% empty %}
    <li>No events yet.</li>
{% endfor %}
</ul>
{% endblock %}
